- name: magenta-stylize
  description: Implementation of the paper "A Learned Representation for Artistic Style"
  operations:
    stylize:
      description: Stylize an image using one of two pretrained models
      cmd: >
        magenta.models.image_stylization.image_stylization_transform
          --output_dir=.
          --output_basename=stylized
      flags:
        style:
          description: Style to apply (monet or varied)
          required: yes
          options:
            - value: monet
              description: Use Monet style
              args:
                checkpoint: multistyle-pastiche-generator-monet.ckpt
                num_styles: 10
            - value: varied
              description: Use varied style
              args:
                checkpoint: multistyle-pastiche-generator-varied.ckpt
                num_styles: 32
        image:
          description: Image to stylize
          required: yes
          arg-name: input_image
      requires:
        - ${style}
  resources:
    monet:
      description: Pretrained model using Monet images
      sources:
        - url: http://download.magenta.tensorflow.org/models/multistyle-pastiche-generator-monet.ckpt
          sha256: 7044c0a6cad9a2865a0aded7567be31437fd6dcc289a40df1efb5096d9a29d88
    varied:
      description: Pretrained model using varied images
      sources:
        - url: http://download.magenta.tensorflow.org/models/multistyle-pastiche-generator-varied.ckpt
          sha256: f0de79e9b91e28e260873cf26cb68589179fe0519c6d1a86a4eb2d4aa5023083

- name: magenta-melody
  description: Applies language modeling to melody generation using an LSTM
  operations:
    compose:
      description: Compose melodies using one of three available pretrained models
      cmd: magenta.models.melody_rnn.melody_rnn_generate --output_dir=.
      flags:
        config:
          description: Model configuration (basic, lookback, or attention)
          value: basic
          options:
            - value: basic
              description: Use basic LSTM
              args:
                config: basic
                bundle_file: basic_rnn.mag
            - value: lookback
              description: Use RNN with lookback
              args:
                config: lookback
                bundle_file: lookback_rnn.mag
            - value: attention
              description: Use RNN with attention
              args:
                config: attention
                bundle_file: attention_rnn.mag
        outputs:
          description: Number of melodies to generate
          value: 10
          arg-name: num_outputs
        steps:
          description: Melody length (16 steps = 1 bar)
          value: 128
        primer-melody:
          description: Melody to prime the generator
        primary-midi:
          description: MIDI file used to prime the generator
      requires:
        - ${config}
  resources:
    basic:
      description: Pretrained melody LSTM
      sources:
        - url: http://download.magenta.tensorflow.org/models/basic_rnn.mag
          sha256: 8726e7427cec1b1a507a8217242e0ffa117c53a4c8d7734fa904e33ee58436ff
    lookback:
      description: Pretrained melody RNN with lookback
      sources:
        - url: http://download.magenta.tensorflow.org/models/lookback_rnn.mag
          sha256: d99de2ae9af9c9e229b0a6ba820b2fe9eef9a735343ecd2a0e41696fbe718736
    attention:
      description: Pretrained melody RNN with attention
      sources:
        - url: http://download.magenta.tensorflow.org/models/attention_rnn.mag
          sha256: ef91c0bcd1c146fdd5cae09f82c8ea3fe2e9164bf782714ff84736ab86514d71

- name: magenta-arbitrary-stylize
  operations:
    stylize:
      description: Stylize using model pretrained on PNB and DRD images
      cmd: >
        magenta.models.arbitrary_image_stylization.arbitrary_image_stylization_with_weights \
          --checkpoint=arbitrary_style_transfer/model.ckpt
          --output_dir=. \
          --content_square_crop=False \
          --style_square_crop=False \
          --logtostderr
      flags:
        content-images:
          description: Path to content images (include glob pattern matching images)
          required: yes
          arg-name: content_images_paths
        style-images:
          description: Path to style images (include glob pattern matching images)
          required: yes
          arg-name: style_images_paths
        image-size:
          description: Size of images
          value: 256
          arg-name: image_size
      requires:
        - pretrained-model
  resources:
    pretrained-model:
      sources:
        - url: https://storage.googleapis.com/download.magenta.tensorflow.org/models/arbitrary_style_transfer.tar.gz
          sha256: 523b600b508e9e1e31d77860d7ff650125b2f41e15dc9d612e15e3600fa65a60
          unpack: yes
