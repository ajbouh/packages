# ===================================================================
# tensorflow.resnet package
# ===================================================================

- package: tensorflow.resnet
  version: 0.3.0
  description: Official TensorFlow ResNet classifier
  url: https://github.com/guildai/index/tree/master/tensorflow/resnet
  maintainer: Guild AI
  maintainer-email: packages@guild.ai
  license: Apache 2.0
  tags:
    - resnet
    - cifar10
    - imagenet
    - images
    - model
    - estimator
    - layers
  resources:
    resnet-lib:
      description: Python library for tensorflow.resnet
      sources:
        - url: https://github.com/tensorflow/models/archive/v.1.6.0.zip
          sha256: ed8fd7066bb014feccaed2cd2a46e516468ef24c40be8ef21a96a09849db7ff5
          select: models-v.1.6.0/official/resnet

# -------------------------------------------------------------------
# ResNet config
# -------------------------------------------------------------------

- config: resnet-model
  operations:
    train:
      flags:
        epochs:
          description: Number of epochs to train
          default: 250
          arg-name: train_epochs
        epochs-per-eval:
          description: Number of epochs to run in between evaluations
          default: 10
        batch-size:
          description: Number of images per batch
          default: 128

# -------------------------------------------------------------------
# resnet-32-cifar10
# -------------------------------------------------------------------

- model: resnet-32-cifar10
  description: ResNet-32 classifier for CIFAR-10
  extends: resnet-model
  operations:
    train:
      description: Train the ResNet model on CIFAR-10 data
      cmd: resnet/cifar10_main --data_dir . --model_dir .
      requires:
        - tensorflow.resnet/resnet-lib
        - dataset
  resources:
    dataset:
      description: CIFAR10 dataset
      sources:
        - url: https://www.cs.toronto.edu/~kriz/cifar-10-binary.tar.gz
          sha256: c4a38c50a1bc5f3a1c5537f2155ab9d68f9f25eb1ed8d9ddda3db29a59bca1dd
  references:
    - https://github.com/tensorflow/models/tree/v.1.6.0/official/resnet
    - https://arxiv.org/pdf/1512.03385.pdf
    - https://arxiv.org/pdf/1603.05027.pdf

# -------------------------------------------------------------------
# resnet-imagenet
# -------------------------------------------------------------------

- model: resnet-imagenet
  description: >
    ResNet classifier for ImageNet

    Note, this model requires that the ImageNet dataset be available
    and prepared as TFRrecords. Refer to https://git.io/vFQNF for
    instructions on preparing the dataset.
  extends: resnet-model
  operations:
    train:
      description: Train the ResNet model on ImageNet data
      cmd: imagenet_main --model_dir .
      flags:
        resnet-size:
          description: Size of the ResNet model to use (18, 34, 50, 101, 152, or 200)
          choices: [18, 34, 50, 101, 152, 200]
          default: 50
        data-dir:
          description: ImageNet data location
          required: yes
      requires:
        - tensorflow.resnet/resnet-lib
  references:
    - https://github.com/tensorflow/models/tree/v.1.6.0/official/resnet
    - https://arxiv.org/pdf/1512.03385.pdf
    - https://arxiv.org/pdf/1603.05027.pdf
